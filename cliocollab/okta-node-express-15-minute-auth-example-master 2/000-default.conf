<VirtualHost *:80>
	ServerName cliocrm.co
	ServerAlias www.cliocrm.co
	ServerAdmin webmaster@localhost
	
	ErrorLog ${APACHE_LOG_DIR}/error.log
	CustomLog ${APACHE_LOG_DIR}/access.log combined

	#RewriteEngine On
	#RewriteCond %{HTTPS} off
	#RewriteRule {.*} https://%{HTTP_HOST}%{REQUEST_URI} [R=301,L]

	Redirect permanent / https://cliocrm.co
</VirtualHost>

<VirtualHost *:80>
	ServerName cliocrm.co
	ServerAlias www.cliocrm.co
	ServerAdmin webmaster@localhost
	
	ErrorLog ${APACHE_LOG_DIR}/error.log
	CustomLog ${APACHE_LOG_DIR}/access.log combined

	#RewriteEngine On
	#RewriteCond %{HTTPS} off
	#RewriteRule {.*} https://%{HTTP_HOST}%{REQUEST_URI} [R=301,L]
	
	Redirect permanent //login/ https://cliocrm.co/login/
	
</VirtualHost>

<VirtualHost *:80>
	ServerName node.cliocrm.co
	ServerAlias www.node.cliocrm.co
	ServerAdmin webmaster@localhost
	
	ErrorLog ${APACHE_LOG_DIR}/error.log
	CustomLog ${APACHE_LOG_DIR}/access.log combined

	#RewriteEngine On
	#RewriteCond %{HTTPS} off
	#RewriteRule {.*} https://%{HTTP_HOST}%{REQUEST_URI} [R=301,L]
	
	Redirect permanent /login/ https://node.cliocrm.co/login/
	
</VirtualHost>

<IfModule mod_ssl.c>
	<VirtualHost *:443>
		ServerName cliocrm.co
		ServerAlias www.cliocrm.co
		ServerAdmin webmaster@localhost


		SSLEngine On
		SSLCertificateKeyFile /etc/letsencrypt/live/cliocrm.co/privkey.pem
		SSLCertificateFile /etc/letsencrypt/live/cliocrm.co/fullchain.pem
		SSLCertificateChainFile /etc/letsencrypt/live/cliocrm.co/chain.pem

		ErrorLog ${APACHE_LOG_DIR}/error.log
		CustomLog ${APACHE_LOG_DIR}/access.log combined

		ProxyPreserveHost On
		ProxyPass / http://localhost:3000
		ProxyPassReverse / http://localhost:3000

	</VirtualHost>

	<VirtualHost *:443>
		ServerName cliocrm.co
		ServerAlias www.cliocrm.co
		ServerAdmin webmaster@localhost


		SSLEngine On
		SSLCertificateKeyFile /etc/letsencrypt/live/cliocrm.co/privkey.pem
		SSLCertificateFile /etc/letsencrypt/live/cliocrm.co/fullchain.pem
		SSLCertificateChainFile /etc/letsencrypt/live/cliocrm.co/chain.pem

		ErrorLog ${APACHE_LOG_DIR}/error.log
		CustomLog ${APACHE_LOG_DIR}/access.log combined
	
		ProxyPreserveHost On
		ProxyPass //login/ http://localhost:3000/login//
		ProxyPassReverse //login/ http://localhost:3000/login//
	</VirtualHost>

	<VirtualHost *:443>
		ServerName node.cliocrm.co
		ServerAlias www.node.cliocrm.co
		ServerAdmin webmaster@localhost

		SSLEngine On
		SSLCertificateKeyFile /etc/letsencrypt/live/cliocrm.co/privkey.pem
		SSLCertificateFile /etc/letsencrypt/live/cliocrm.co/fullchain.pem
		SSLCertificateChainFile /etc/letsencrypt/live/cliocrm.co/chain.pem

		ErrorLog ${APACHE_LOG_DIR}/error.log
		CustomLog ${APACHE_LOG_DIR}/access.log combined

		ProxyPreserveHost On
		ProxyPassReverse /login/ http://localhost:3000/login/
		ProxyPass /login/ http://localhost:3000/login/
	</VirtualHost>
</IfModule>
# vim: syntax=apache ts=4 sw=4 sts=4 sr noet
